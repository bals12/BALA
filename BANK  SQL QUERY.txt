

BANK SQL QUERY

@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

1)Display the Female customer who are from 'karnataka'

SELECT CUST_NAME FROM CUSTOMER WHERE STATE = 'KARNATAKA' AND GENDER = 'F';


2)Display the customer who have the highest balance across all account types				

SELECT CUST_NAME 
FROM CUSTOMER INNER JOIN ACCOUNTS ON CUSTOMER.CUST_BKEY = ACCOUNTS.CUST_BKEY
WHERE BALANCE =
( SELECT MAX(BALANCE) FROM ACCOUNTS);


3)Display the State wise no of accounts opened in the previous year			

SELECT STATE,COUNT(A_NO)
FROM CUSTOMER INNER JOIN ACCOUNTS ON CUSTOMER.CUST_BKEY = ACCOUNTS.CUST_BKEY
GROUP BY STATE;


4)Display customer name and transaction type wise transaction amounts

				
SELECT TEMP1.CUSTOMER,TEMP2.TXN_TYPE,TEMP2.FCY_AMT,TEMP2.LCY_AMT
FROM
(SELECT CUSTOMER,A_NO FROM CUSTOMER INNER JOIN ACCOUNTS ON CUSTOMER.CUST_BKEY = ACCOUNT.CUST_BKEY)TEMP1
INNER JOIN
(SELECT ACCOUNTS.A_NO,TXN_TYPE,FCY_AMT,LCY_AMT FROM ACCOUNTS INNER JOIN TRANSACTION ON ACCOUNTS.A_NO = TRANSACTION.A_NO)TEMP2
ON TEMP1.A_NO = TEMP2.A_NO


5)Display city wise no of male and female customers		

SELECT CITY,COUNT(GENDER)
FROM CUSTOMER
WHERE GENDER = 'M'
GROUP BY CITY

UNION

SELECT CITY,COUNT(GENDER)
FROM CUSTOMER
WHERE GENDER = 'F'
GROUP BY CITY


6)Display the cities that have more number of customers than the city BTM

SELECT CITY, COUNT(CUST_NAME) FROM CUSTOMER WHERE COUNT(CUST_NAME) > 
(SELECT COUNT(CUST_NAME) FROM CUSTOMER WHERE CITY = 'BTM')



7)Display the customer name who have the highest balance in individual account types				

SELECT CUST_NAME FROM CUSTOMER INNER JOIN ACCOUNTS ON CUSTOMER.CUST_BKEY = ACCOUNTS.CUST_BKEY
WHERE BALANCE=
(SELECT MAX(BALANCE) FROM ACCOUNTS);


8)Display the which is the  common act_type hold by 'MONI' and 'ANANYA'				

SELECT ACT_TYPE FROM CUSTOMER INNER JOIN ACCOUNTS ON CUSTOMER.CUST_BKEY = ACCOUNTS.CUST_BKEY
WHERE CUST_NAME = 'MONI' AND CUST_NAME = 'ANANYA';


9)Write a query to display all the customers and the number of accounts they hold				

SELECT CUST_NAME, COUNT(A_NO) FROM CUSTOMER INNER JOIN ACCOUNTS ON CUSTOMER.CUST_BKEY = ACCOUNTS.CUST_BKEY
GROUP BY CUST_NAME


 
10)Display customer who made a transaction in current year march month	

SELECT CUST_NAME
FROM
(SELECT CUST_NAME,A_NO FROM CUSTOMER INNER JOIN ACCOUNTS ON CUSTOMER.CUST_BKEY = ACCOUNTS.CUST_BKEY)TEMP1
INNER JOIN
(SELECT A_NO,TXN_DATE FROM ACCOUNTS INNER JOIN TRANSACTION ON ACCOUNTS.A_NO = TRANSACTION.A_NO)TEMP2
ON TEMP1.A_NO = TEMP2.A_NO
WHERE TXN_DATE = '25-03-2022';
			
		
